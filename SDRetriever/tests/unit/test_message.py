
import json
from datetime import datetime

import pytest

from sdretriever.message import Chunk
from sdretriever.message import Message
from sdretriever.message import SnapshotMessage
from sdretriever.message import VideoMessage

sqs_message_queue_selector_with_chunks = {'MessageId': '9d0d5095-5b12-496d-9d32-46f477e2c0f2', 'ReceiptHandle': 'AQEBJwODnCptuyyUwtE8HIF/S8H+Rv5gy/MnO05rJLD+ODNtrEFma2OMkD/68lRSuc9ulViLw92+MgigTrJsa+iGEDAvExyna5ypu9H7RVPHklmXYBzup0zeQMG5r/Ct3iPtVD9jQR6y3JRZ+f4Fz0+x5AAf9GVPPg3nsdNu1cF3oJOBv9d0WKJEdj8wtkvy8aEADo1AWO7tM+rK1R27zPbQ7477c+bgl9msohH5fDHatTLIwUBKDnkijsr9TA8/SETMzR8dJErfpTfUkKMFWRNYYUG+zhDenOFJgJoR6DFHs5FihElsCMvq2/7ys/+ZG7Ub4JVRoirLLZG7UCFwiGi3H3aZEqW2Qhpx8sxJl5zkw4EEtlpBobFlMoM1+BpNGGWDXbqT59v/9zzgbVIsNTQzTC8rBqWiqftuFe4R75ECp3c=', 'MD5OfBody': '19591af385c42dbd9958dab4bb94a25a', 'Body': '{\n  "Type" : "Notification",\n  "MessageId" : "03ae7a69-59a1-57a7-a728-2129b1a15f07",\n  "TopicArn" : "arn:aws:sns:eu-central-1:736745337734:prod-inputEventsTerraform",\n  "Message" : "{\\"topic\\":\\"com.bosch.rcc/rc_srx_prod_fca86a5cbeeb86c1d4747f94d7cbeef782f13105/things/twin/events/modified\\",\\"headers\\":{\\"orig_adapter\\":\\"hono-mqtt\\",\\"qos\\":\\"1\\",\\"device_id\\":\\"com.bosch.rcc:rc_srx_prod_fca86a5cbeeb86c1d4747f94d7cbeef782f13105\\",\\"creation-time\\":\\"1657202112755\\",\\"traceparent\\":\\"00-119b69b9d1f2d422ea904b8ec66ff187-2249acdcb0b8aedf-01\\",\\"kafka.timestamp\\":\\"1657202112755\\",\\"kafka.topic\\":\\"hono.telemetry.tbccf1729c0ac4f748ef8c4a62a953076_hub\\",\\"orig_address\\":\\"telemetry\\",\\"kafka.key\\":\\"com.bosch.rcc:rc_srx_prod_fca86a5cbeeb86c1d4747f94d7cbeef782f13105\\",\\"ditto-originator\\":\\"integration:bccf1729-c0ac-4f74-8ef8-c4a62a953076_things:hub\\",\\"response-required\\":false,\\"version\\":2,\\"requested-acks\\":[],\\"content-type\\":\\"application/json\\",\\"correlation-id\\":\\"777f48ff-ea2d-4086-8719-fb66d0f953ae\\"},\\"path\\":\\"/features/com.bosch.ivs.videorecorder.UploadRecordingEvent\\",\\"value\\":{\\"properties\\":{\\"header\\":{\\"message_type\\":\\"com.bosch.ivs.videorecorder.UploadRecordingEvent\\",\\"timestamp_ms\\":1657202104495,\\"message_id\\":\\"d449b30d-628f-4413-8005-d47752ebe78f\\",\\"device_id\\":\\"rc_srx_prod_fca86a5cbeeb86c1d4747f94d7cbeef782f13105\\",\\"boot_id\\":\\"2c9bd397-0dcc-4037-befa-105cacaaab50\\"},\\"correlation_id\\":\\"fe6fb4d4-1c74-41b0-98c5-682a63b1a60f\\",\\"recording_id\\":\\"TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976\\",\\"recorder_name\\":\\"TrainingRecorder\\",\\"chunk_descriptions\\":[{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_1.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198269134,\\"end_timestamp_ms\\":1657198280364,\\"payload_size\\":458161},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_2.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198280367,\\"end_timestamp_ms\\":1657198291792,\\"payload_size\\":449931},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_3.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198291793,\\"end_timestamp_ms\\":1657198303221,\\"payload_size\\":449203},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_4.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198303222,\\"end_timestamp_ms\\":1657198314656,\\"payload_size\\":455017},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_5.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198314657,\\"end_timestamp_ms\\":1657198326087,\\"payload_size\\":465816},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_6.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198326089,\\"end_timestamp_ms\\":1657198337620,\\"payload_size\\":554114},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_7.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198337622,\\"end_timestamp_ms\\":1657198349053,\\"payload_size\\":449896},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_8.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198349057,\\"end_timestamp_ms\\":1657198360484,\\"payload_size\\":459984},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_9.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198360485,\\"end_timestamp_ms\\":1657198371910,\\"payload_size\\":454078},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_10.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198371912,\\"end_timestamp_ms\\":1657198383342,\\"payload_size\\":460912},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_11.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198383343,\\"end_timestamp_ms\\":1657198394872,\\"payload_size\\":449743},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_12.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198394873,\\"end_timestamp_ms\\":1657198406303,\\"payload_size\\":454180},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_13.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198406304,\\"end_timestamp_ms\\":1657198417744,\\"payload_size\\":448928},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_14.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198417752,\\"end_timestamp_ms\\":1657198429197,\\"payload_size\\":454567},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_15.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198429200,\\"end_timestamp_ms\\":1657198440636,\\"payload_size\\":457775},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_16.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198440640,\\"end_timestamp_ms\\":1657198452072,\\"payload_size\\":449104},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_17.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198452075,\\"end_timestamp_ms\\":1657198463507,\\"payload_size\\":471979},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_18.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198463510,\\"end_timestamp_ms\\":1657198474945,\\"payload_size\\":448159},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_19.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198474946,\\"end_timestamp_ms\\":1657198486374,\\"payload_size\\":525845},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_20.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198486381,\\"end_timestamp_ms\\":1657198497807,\\"payload_size\\":432650},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_21.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198497807,\\"end_timestamp_ms\\":1657198509334,\\"payload_size\\":409513},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_22.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198509336,\\"end_timestamp_ms\\":1657198520769,\\"payload_size\\":413137},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_23.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198520772,\\"end_timestamp_ms\\":1657198532200,\\"payload_size\\":423002},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_24.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198532201,\\"end_timestamp_ms\\":1657198543630,\\"payload_size\\":420944},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_25.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198543631,\\"end_timestamp_ms\\":1657198555061,\\"payload_size\\":420721},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_26.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198555061,\\"end_timestamp_ms\\":1657198566590,\\"payload_size\\":429327},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_27.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198566596,\\"end_timestamp_ms\\":1657198577931,\\"payload_size\\":424334},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_28.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198577934,\\"end_timestamp_ms\\":1657198589464,\\"payload_size\\":441532},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_29.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198589465,\\"end_timestamp_ms\\":1657198600895,\\"payload_size\\":441263},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_30.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198600896,\\"end_timestamp_ms\\":1657198612327,\\"payload_size\\":412867},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_31.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198612328,\\"end_timestamp_ms\\":1657198623756,\\"payload_size\\":411724},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_32.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198623757,\\"end_timestamp_ms\\":1657198635284,\\"payload_size\\":411861},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_33.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198635285,\\"end_timestamp_ms\\":1657198646712,\\"payload_size\\":414972},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_34.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198646718,\\"end_timestamp_ms\\":1657198658145,\\"payload_size\\":416519},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_35.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198658146,\\"end_timestamp_ms\\":1657198669581,\\"payload_size\\":416807},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_36.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198669585,\\"end_timestamp_ms\\":1657198681014,\\"payload_size\\":424237},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_37.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198681015,\\"end_timestamp_ms\\":1657198692542,\\"payload_size\\":444180},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_38.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198692543,\\"end_timestamp_ms\\":1657198703871,\\"payload_size\\":413529},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_39.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198703872,\\"end_timestamp_ms\\":1657198715405,\\"payload_size\\":416495},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_40.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198715405,\\"end_timestamp_ms\\":1657198726852,\\"payload_size\\":422131},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_41.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198726853,\\"end_timestamp_ms\\":1657198738281,\\"payload_size\\":412245},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_42.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198738283,\\"end_timestamp_ms\\":1657198749707,\\"payload_size\\":408341},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_43.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198749709,\\"end_timestamp_ms\\":1657198761147,\\"payload_size\\":641613},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_44.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198761148,\\"end_timestamp_ms\\":1657198772677,\\"payload_size\\":392674},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_45.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198772678,\\"end_timestamp_ms\\":1657198784104,\\"payload_size\\":394525},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_46.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198784105,\\"end_timestamp_ms\\":1657198795537,\\"payload_size\\":392245},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_47.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198795538,\\"end_timestamp_ms\\":1657198806986,\\"payload_size\\":394178},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_48.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198806987,\\"end_timestamp_ms\\":1657198818416,\\"payload_size\\":394968},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_49.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198818417,\\"end_timestamp_ms\\":1657198829857,\\"payload_size\\":395011},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_50.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198829858,\\"end_timestamp_ms\\":1657198841289,\\"payload_size\\":395057},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_51.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198841295,\\"end_timestamp_ms\\":1657198852729,\\"payload_size\\":396193},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_52.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198852732,\\"end_timestamp_ms\\":1657198864263,\\"payload_size\\":394308},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_53.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198864265,\\"end_timestamp_ms\\":1657198875698,\\"payload_size\\":395238},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_54.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198875698,\\"end_timestamp_ms\\":1657198887125,\\"payload_size\\":394254},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-b2022-07-07T13:56:43.034920510Z f45-3997de29a976_55.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198887126,\\"end_timestamp_ms\\":1657198898553,\\"payload_size\\":394675},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_56.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198898554,\\"end_timestamp_ms\\":1657198910084,\\"payload_size\\":577896},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_57.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198910085,\\"end_timestamp_ms\\":1657198921412,\\"payload_size\\":426716},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_58.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198921413,\\"end_timestamp_ms\\":1657198932946,\\"payload_size\\":402932},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_59.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198932948,\\"end_timestamp_ms\\":1657198944387,\\"payload_size\\":398683},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_60.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198944388,\\"end_timestamp_ms\\":1657198955814,\\"payload_size\\":392716},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_61.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198955817,\\"end_timestamp_ms\\":1657198967245,\\"payload_size\\":390511},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_62.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198967257,\\"end_timestamp_ms\\":1657198978686,\\"payload_size\\":417165},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_63.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198978688,\\"end_timestamp_ms\\":1657198990217,\\"payload_size\\":427929},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_64.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657198990217,\\"end_timestamp_ms\\":1657199001547,\\"payload_size\\":407199},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_65.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199001548,\\"end_timestamp_ms\\":1657199013077,\\"payload_size\\":393992},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_66.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199013078,\\"end_timestamp_ms\\":1657199024505,\\"payload_size\\":399459},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_67.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199024506,\\"end_timestamp_ms\\":1657199035943,\\"payload_size\\":391865},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_68.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199035944,\\"end_timestamp_ms\\":1657199047385,\\"payload_size\\":408273},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_69.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199047387,\\"end_timestamp_ms\\":1657199058812,\\"payload_size\\":490001},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_70.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199058813,\\"end_timestamp_ms\\":1657199070343,\\"payload_size\\":403681},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_71.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199070345,\\"end_timestamp_ms\\":1657199081776,\\"payload_size\\":493057},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_72.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199081777,\\"end_timestamp_ms\\":1657199093209,\\"payload_size\\":413241},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_73.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199093212,\\"end_timestamp_ms\\":1657199104646,\\"payload_size\\":415625},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_74.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199104650,\\"end_timestamp_ms\\":1657199116079,\\"payload_size\\":407731},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_75.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199116082,\\"end_timestamp_ms\\":1657199127526,\\"payload_size\\":1331374},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_76.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199127530,\\"end_timestamp_ms\\":1657199138972,\\"payload_size\\":537904},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_77.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199138975,\\"end_timestamp_ms\\":1657199150501,\\"payload_size\\":409393},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_78.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199150504,\\"end_timestamp_ms\\":1657199161938,\\"payload_size\\":423590},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_79.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199161940,\\"end_timestamp_ms\\":1657199173375,\\"payload_size\\":407794},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_80.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199173381,\\"end_timestamp_ms\\":1657199184815,\\"payload_size\\":399620},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_81.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199184816,\\"end_timestamp_ms\\":1657199196251,\\"payload_size\\":399849},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_82.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199196253,\\"end_timestamp_ms\\":1657199207685,\\"payload_size\\":477180},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_83.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199207686,\\"end_timestamp_ms\\":1657199219115,\\"payload_size\\":397094},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_84.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199219117,\\"end_timestamp_ms\\":1657199230547,\\"payload_size\\":419059},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_85.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199230548,\\"end_timestamp_ms\\":1657199242085,\\"payload_size\\":391580},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_86.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199242086,\\"end_timestamp_ms\\":1657199253528,\\"payload_size\\":388141},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_87.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199253533,\\"end_timestamp_ms\\":1657199264863,\\"payload_size\\":521486},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_88.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199264866,\\"end_timestamp_ms\\":1657199276394,\\"payload_size\\":388416},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_89.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199276395,\\"end_timestamp_ms\\":1657199287823,\\"payload_size\\":391140},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_90.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199287824,\\"end_timestamp_ms\\":1657199299354,\\"payload_size\\":392630},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_91.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199299356,\\"end_timestamp_ms\\":1657199310693,\\"payload_size\\":419302},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_92.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199310696,\\"end_timestamp_ms\\":1657199322122,\\"payload_size\\":385987},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_93.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199322123,\\"end_timestamp_ms\\":1657199333653,\\"payload_size\\":394921},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_94.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199333655,\\"end_timestamp_ms\\":1657199345081,\\"payload_size\\":377384},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_95.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199345084,\\"end_timestamp_ms\\":1657199356512,\\"payload_size\\":415715},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_96.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199356516,\\"end_timestamp_ms\\":1657199367939,\\"payload_size\\":481567},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_97.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199367940,\\"end_timestamp_ms\\":1657199379468,\\"payload_size\\":511234},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_98.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199379470,\\"end_timestamp_ms\\":1657199390796,\\"payload_size\\":375333},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_99.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199390806,\\"end_timestamp_ms\\":1657199402331,\\"payload_size\\":491385},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_100.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199402332,\\"end_timestamp_ms\\":1657199413763,\\"payload_size\\":576454},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_101.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199413764,\\"end_timestamp_ms\\":1657199425193,\\"payload_size\\":463045},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_102.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199425195,\\"end_timestamp_ms\\":1657199436722,\\"payload_size\\":667923},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_103.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199436723,\\"end_timestamp_ms\\":1657199448146,\\"payload_size\\":463849},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_104.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199448147,\\"end_timestamp_ms\\":1657199459577,\\"payload_size\\":572684},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_105.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199459579,\\"end_timestamp_ms\\":1657199471004,\\"payload_size\\":405535},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_106.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199471006,\\"end_timestamp_ms\\":1657199482433,\\"payload_size\\":751721},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_107.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199482438,\\"end_timestamp_ms\\":1657199493864,\\"payload_size\\":402810},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_108.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199493868,\\"end_timestamp_ms\\":1657199505402,\\"payload_size\\":390336},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_109.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199505403,\\"end_timestamp_ms\\":1657199516833,\\"payload_size\\":522076},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_110.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199516836,\\"end_timestamp_ms\\":1657199528266,\\"payload_size\\":408828},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_111.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199528267,\\"end_timestamp_ms\\":1657199539697,\\"payload_size\\":452046},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_112.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199539698,\\"end_timestamp_ms\\":1657199551130,\\"payload_size\\":808122},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_113.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199551132,\\"end_timestamp_ms\\":1657199562662,\\"payload_size\\":697953},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_114.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199562663,\\"end_timestamp_ms\\":1657199573996,\\"payload_size\\":586073},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_115.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199573997,\\"end_timestamp_ms\\":1657199585530,\\"payload_size\\":703404},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_116.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199585531,\\"end_timestamp_ms\\":1657199596958,\\"payload_size\\":617294},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_117.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199596959,\\"end_timestamp_ms\\":1657199608389,\\"payload_size\\":653975},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd42022-07-07T13:56:43.034920510Z 8be-0b8d-4202-bf45-3997de29a976_118.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199608390,\\"end_timestamp_ms\\":1657199619827,\\"payload_size\\":447230},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_119.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199619829,\\"end_timestamp_ms\\":1657199631259,\\"payload_size\\":419432},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_120.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199631259,\\"end_timestamp_ms\\":1657199642792,\\"payload_size\\":440108},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_121.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199642796,\\"end_timestamp_ms\\":1657199654125,\\"payload_size\\":545071},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_122.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199654126,\\"end_timestamp_ms\\":1657199665660,\\"payload_size\\":424258},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_123.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199665661,\\"end_timestamp_ms\\":1657199677090,\\"payload_size\\":430640},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_124.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199677093,\\"end_timestamp_ms\\":1657199688532,\\"payload_size\\":422047},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_125.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199688535,\\"end_timestamp_ms\\":1657199699969,\\"payload_size\\":367299},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_126.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199699973,\\"end_timestamp_ms\\":1657199711403,\\"payload_size\\":373992},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_127.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199711406,\\"end_timestamp_ms\\":1657199722941,\\"payload_size\\":363098},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_128.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199722945,\\"end_timestamp_ms\\":1657199734292,\\"payload_size\\":366763},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_129.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199734293,\\"end_timestamp_ms\\":1657199745726,\\"payload_size\\":367492},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_130.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199745727,\\"end_timestamp_ms\\":1657199757268,\\"payload_size\\":396610},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_131.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199757269,\\"end_timestamp_ms\\":1657199768696,\\"payload_size\\":428939},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_132.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199768697,\\"end_timestamp_ms\\":1657199780124,\\"payload_size\\":445540},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_133.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199780125,\\"end_timestamp_ms\\":1657199791549,\\"payload_size\\":369467},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_134.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199791550,\\"end_timestamp_ms\\":1657199803078,\\"payload_size\\":403654},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_135.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199803079,\\"end_timestamp_ms\\":1657199814507,\\"payload_size\\":404659},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_136.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199814508,\\"end_timestamp_ms\\":1657199825939,\\"payload_size\\":373918},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_137.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199825940,\\"end_timestamp_ms\\":1657199837370,\\"payload_size\\":567688},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_138.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199837371,\\"end_timestamp_ms\\":1657199848797,\\"payload_size\\":402999},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_139.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199848798,\\"end_timestamp_ms\\":1657199860340,\\"payload_size\\":407407},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_140.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199860341,\\"end_timestamp_ms\\":1657199871672,\\"payload_size\\":378669},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_141.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199871673,\\"end_timestamp_ms\\":1657199883199,\\"payload_size\\":372724},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_142.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199883200,\\"end_timestamp_ms\\":1657199894632,\\"payload_size\\":386635},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_143.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199894633,\\"end_timestamp_ms\\":1657199906061,\\"payload_size\\":378396},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_144.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199906062,\\"end_timestamp_ms\\":1657199917495,\\"payload_size\\":378011},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_145.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199917498,\\"end_timestamp_ms\\":1657199928933,\\"payload_size\\":366278},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_146.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199928934,\\"end_timestamp_ms\\":1657199940464,\\"payload_size\\":375852},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_147.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199940467,\\"end_timestamp_ms\\":1657199951795,\\"payload_size\\":380289},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_148.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199951796,\\"end_timestamp_ms\\":1657199963328,\\"payload_size\\":404326},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_149.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199963329,\\"end_timestamp_ms\\":1657199974756,\\"payload_size\\":396175},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_150.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199974757,\\"end_timestamp_ms\\":1657199986193,\\"payload_size\\":400185},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_151.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199986203,\\"end_timestamp_ms\\":1657199997636,\\"payload_size\\":699865},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_152.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657199997638,\\"end_timestamp_ms\\":1657200009073,\\"payload_size\\":645892},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_153.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657200009074,\\"end_timestamp_ms\\":1657200020603,\\"payload_size\\":433918},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_154.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657200020605,\\"end_timestamp_ms\\":1657200032041,\\"payload_size\\":381101},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_155.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657200032043,\\"end_timestamp_ms\\":1657200043473,\\"payload_size\\":386029},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_156.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657200043473,\\"end_timestamp_ms\\":1657200054902,\\"payload_size\\":622896},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_157.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__SELECTED_FOR_UPLOAD\\",\\"start_timestamp_ms\\":1657200054903,\\"end_timestamp_ms\\":1657200066335,\\"payload_size\\":619070},{\\"uuid\\":\\"TrainingRecorder_TrainingRecorder-c1dd48be-0b8d-4202-bf45-3997de29a976_158.mp4\\",\\"upload_status\\":\\"UPLOAD_STATUS__ALREADY_UPLOADED\\",\\"start_timestamp_ms\\":1657200066336,\\"end_timestamp_ms\\":1657200077872}],\\"command_status\\":{\\"status_code\\":\\"COMMAND_STATUS_CODE__OK\\"}}},\\"extra\\":{\\"attributes\\":{\\"vin\\":\\"unknown\\",\\"tenant\\":\\"srxfut3\\",\\"vehicleType\\":\\"CARMODEL__FIAT_500_312\\",\\"subjectId\\":\\"e0afa7df-13d8-49d0-8ece-e34b307f72fd\\",\\"operationMode\\":\\"SRX\\",\\"deviceType\\":\\"hailysharey\\"}},\\"revision\\":9908,\\"timestamp\\":\\"2022-07-07T13:55:12.832435504Z\\"}",\n  "Timestamp" : "2022-07-07T13:55:12.942Z",\n  "SignatureVersion" : "1",\n  "Signature" : "gCaWSXNl/ApKuSaJWpsusO7R49goSl7+B2vqptL1LN6LMsWLDFO16M6VFwo1APn3hiwXGzgFKk3PrUX9dKJBgB5PL8yqkLBcDUY0N3fV+JaDzF+fHtdse1I25vLGUzYgEhu9ftkq1/yjvt+vYw204N4ZCjJPuFVqmg9ZonJYSGn1GcSZflz65AZEfm32mbjNy1qNM51SEjgmFirHLCHmfzMUh5BWTvrqoYRpe7eoMa0dQ5VfIbjgEQVO1jxmtctmKkzfwjBFWfajwiS33yy2qyL0VS6W4OQTv5sdMG6rJFDDvxmBM+x2509NkO+QUuTKzexvXHEJ3v2pHhtR6u1mcg==",\n  "SigningCertURL" : "https://sns.eu-central-1.amazonaws.com/SimpleNotificationService-7ff5318490ec183fbaddaa2a969abfda.pem",\n  "UnsubscribeURL" : "https://sns.eu-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:eu-central-1:736745337734:prod-inputEventsTerraform:23a2a7a5-1fd3-4bbe-b766-1da13b0577d9",\n  "MessageAttributes" : {\n    "deviceType" : {"Type":"String","Value":"hailysharey"},\n    "operationMode" : {"Type":"String","Value":"SRX"},\n    "eventType" : {"Type":"String","Value":"com.bosch.ivs.videorecorder.UploadRecordingEvent"},\n    "tenant" : {"Type":"String","Value":"srxfut3"},\n    "subjectId" : {"Type":"String","Value":"e0afa7df-13d8-49d0-8ece-e34b307f72fd"}\n  }\n}', 'Attributes': {'SentTimestamp': '1657202113004'}}
sqs_message_queue_selector_good_tenant = {
    'MessageId': '8e8d79bb-8a6b-4461-a94d-51c7aa9bb0f1',
    'ReceiptHandle': 'AQEBtCBwuG54U0wqc572u5hzyBPmxsd7I+cOT7zAsKG4foVAvgYTG5UDz3DZ07IG6t61OKtInqBeOGpLA0AhQOPdHum2hRXA8RHwu7iznWK6wll/mZGKtLIyPHUG5NflRllxCY698TeVxyqvGgKqWqTQipV1XOTGpxw4X+5L1ScIsTdlLrj1KAGl61h5s+ZEOOvoQiMdP2ecYshf9LSul80BLdNe8l5iAsg/JJwODYhv/hubXSAKjDrLuDxjPQNq8PaCP+WC5h0iWeP3WsPfq1uXvulkPxdm8PGADJJuBw9vwSoHqociFlDP08hYZDqzi5EMDe8+PCoC26l4V9oQ/cWq8k7Peh2nsBulp2f6NIWfen9/5YDkkNVrwMy8MXmmUg7YNPVboGjgeVAfrExighxI+o4/KqgqonU1Qznd44r0nYU=',
    'MD5OfBody': 'cfe61891e60d51ca14d662c3cfed3a76',
    'Body': '{\n  "Type" : "Notification",\n  "MessageId" : "a24584ea-fe55-56a9-bd2f-dfada4266b2c",\n  "TopicArn" : "arn:aws:sns:eu-central-1:736745337734:prod-inputEventsTerraform",\n  "Message" : "{\\"topic\\":\\"com.bosch.rcc/srx_herbie_test_sim_am_01/things/twin/events/modified\\",\\"headers\\":{\\"orig_adapter\\":\\"hono-mqtt\\",\\"qos\\":\\"1\\",\\"device_id\\":\\"com.bosch.rcc:srx_herbie_test_sim_am_01\\",\\"creation-time\\":\\"1657624627540\\",\\"traceparent\\":\\"00-0a84e899503b765b0ca9c96d86390022-98345f5e303cee11-00\\",\\"kafka.timestamp\\":\\"1657624627540\\",\\"kafka.topic\\":\\"hono.telemetry.tbccf1729c0ac4f748ef8c4a62a953076_hub\\",\\"orig_address\\":\\"telemetry\\",\\"kafka.key\\":\\"com.bosch.rcc:srx_herbie_test_sim_am_01\\",\\"ditto-originator\\":\\"integration:bccf1729-c0ac-4f74-8ef8-c4a62a953076_things:hub\\",\\"response-required\\":false,\\"version\\":2,\\"requested-acks\\":[],\\"content-type\\":\\"application/json\\",\\"correlation-id\\":\\"2c17e5c9-e687-42a4-914e-1fdac9d42af3\\"},\\"path\\":\\"/features/com.bosch.ivs.videorecorder.UploadRecordingEvent\\",\\"value\\":{\\"properties\\":{\\"header\\":{\\"message_type\\":\\"com.bosch.ivs.videorecorder.UploadRecordingEvent\\",\\"timestamp_ms\\":1657624627537,\\"message_id\\":\\"de13f5cc-dfea-46da-8d89-9e3884e30a24\\",\\"device_id\\":\\"srx_herbie_test_sim_am_01\\",\\"boot_id\\":\\"d20ba602-2c06-4405-8ed5-db941573dbbe\\"},\\"correlation_id\\":\\"bda19c79-eac4-4d87-af31-632208257ab3\\",\\"recording_id\\":\\"TrainingMultiSnapshot-bc4d26db-9689-4d77-b173-a21fb26776fa\\",\\"recorder_name\\":\\"TrainingMultiSnapshot\\",\\"command_status\\":{\\"status_code\\":\\"COMMAND_STATUS_CODE__OK\\",\\"details\\":\\"COMMAND_STATUS_CODE__OK\\"}}},\\"extra\\":{\\"attributes\\":{\\"vin\\":\\"unknown\\",\\"tenant\\":\\"DATANAUTS\\",\\"vehicleType\\":\\"CARMODEL__FIAT_500_312\\",\\"subjectId\\":\\"15afc9be-5e9f-4ca0-b5bd-795420876b09\\",\\"operationMode\\":\\"SAFETY_CALL\\",\\"deviceType\\":\\"hailysharey\\"}},\\"revision\\":4206,\\"timestamp\\":\\"2022-07-12T11:17:07.551341075Z\\"}",\n  "Timestamp" : "2022-07-12T11:17:07.585Z",\n  "SignatureVersion" : "1",\n  "Signature" : "p8ZAMYlyEkbAG+Bg31+ZmUVvw4LN7FC40JoGmGD1Cye7qJh4dXLIuptICLYvMgcYjeb5SVEavW7DWm7dKALGYuRnJH5ffy4Kwd7P6P63IOD1tLHvYMpGSxwSJX4gvgBW6juqkd3lqLrwOVQ21PgGVtdFI/xD8BK7UhDutQZKtWhDXVAWpV1Bqls0m6edOoGu+yhfBwOGG7Kv+AYXQ63xgKseZnsLCRMU5KU4la10Ik/zjk6HSgsI2iWE5hEK1nMWH+Lrb4gxfLjnOGJaUyTxUc6c5uapWPnytc9bKz9/ARqaXgV146nzzr86vjlk26bRayLX9Q5H6mm/wTmQPg1uDw==",\n  "SigningCertURL" : "https://sns.eu-central-1.amazonaws.com/SimpleNotificationService-7ff5318490ec183fbaddaa2a969abfda.pem",\n  "UnsubscribeURL" : "https://sns.eu-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:eu-central-1:736745337734:prod-inputEventsTerraform:23a2a7a5-1fd3-4bbe-b766-1da13b0577d9",\n  "MessageAttributes" : {\n    "deviceType" : {"Type":"String","Value":"hailysharey"},\n    "operationMode" : {"Type":"String","Value":"SAFETY_CALL"},\n    "eventType" : {"Type":"String","Value":"com.bosch.ivs.videorecorder.UploadRecordingEvent"},\n    "tenant" : {"Type":"String","Value":"DATANAUTS"},\n    "subjectId" : {"Type":"String","Value":"15afc9be-5e9f-4ca0-b5bd-795420876b09"}\n  }\n}',
    'Attributes': {
        'SentTimestamp': '1657624627631'}}
sqs_message_queue_selector = {
    'MessageId': '8e8d79bb-8a6b-4461-a94d-51c7aa9bb0f1',
    'ReceiptHandle': 'AQEBtCBwuG54U0wqc572u5hzyBPmxsd7I+cOT7zAsKG4foVAvgYTG5UDz3DZ07IG6t61OKtInqBeOGpLA0AhQOPdHum2hRXA8RHwu7iznWK6wll/mZGKtLIyPHUG5NflRllxCY698TeVxyqvGgKqWqTQipV1XOTGpxw4X+5L1ScIsTdlLrj1KAGl61h5s+ZEOOvoQiMdP2ecYshf9LSul80BLdNe8l5iAsg/JJwODYhv/hubXSAKjDrLuDxjPQNq8PaCP+WC5h0iWeP3WsPfq1uXvulkPxdm8PGADJJuBw9vwSoHqociFlDP08hYZDqzi5EMDe8+PCoC26l4V9oQ/cWq8k7Peh2nsBulp2f6NIWfen9/5YDkkNVrwMy8MXmmUg7YNPVboGjgeVAfrExighxI+o4/KqgqonU1Qznd44r0nYU=',
    'MD5OfBody': 'cfe61891e60d51ca14d662c3cfed3a76',
    'Body': '{\n  "Type" : "Notification",\n  "MessageId" : "a24584ea-fe55-56a9-bd2f-dfada4266b2c",\n  "TopicArn" : "arn:aws:sns:eu-central-1:736745337734:prod-inputEventsTerraform",\n  "Message" : "{\\"topic\\":\\"com.bosch.rcc/srx_herbie_test_sim_am_01/things/twin/events/modified\\",\\"headers\\":{\\"orig_adapter\\":\\"hono-mqtt\\",\\"qos\\":\\"1\\",\\"device_id\\":\\"com.bosch.rcc:srx_herbie_test_sim_am_01\\",\\"creation-time\\":\\"1657624627540\\",\\"traceparent\\":\\"00-0a84e899503b765b0ca9c96d86390022-98345f5e303cee11-00\\",\\"kafka.timestamp\\":\\"1657624627540\\",\\"kafka.topic\\":\\"hono.telemetry.tbccf1729c0ac4f748ef8c4a62a953076_hub\\",\\"orig_address\\":\\"telemetry\\",\\"kafka.key\\":\\"com.bosch.rcc:srx_herbie_test_sim_am_01\\",\\"ditto-originator\\":\\"integration:bccf1729-c0ac-4f74-8ef8-c4a62a953076_things:hub\\",\\"response-required\\":false,\\"version\\":2,\\"requested-acks\\":[],\\"content-type\\":\\"application/json\\",\\"correlation-id\\":\\"2c17e5c9-e687-42a4-914e-1fdac9d42af3\\"},\\"path\\":\\"/features/com.bosch.ivs.videorecorder.UploadRecordingEvent\\",\\"value\\":{\\"properties\\":{\\"header\\":{\\"message_type\\":\\"com.bosch.ivs.videorecorder.UploadRecordingEvent\\",\\"timestamp_ms\\":1657624627537,\\"message_id\\":\\"de13f5cc-dfea-46da-8d89-9e3884e30a24\\",\\"device_id\\":\\"srx_herbie_test_sim_am_01\\",\\"boot_id\\":\\"d20ba602-2c06-4405-8ed5-db941573dbbe\\"},\\"correlation_id\\":\\"bda19c79-eac4-4d87-af31-632208257ab3\\",\\"recording_id\\":\\"TrainingMultiSnapshot-bc4d26db-9689-4d77-b173-a21fb26776fa\\",\\"recorder_name\\":\\"TrainingMultiSnapshot\\",\\"command_status\\":{\\"status_code\\":\\"COMMAND_STATUS_CODE__OK\\",\\"details\\":\\"COMMAND_STATUS_CODE__OK\\"}}},\\"extra\\":{\\"attributes\\":{\\"vin\\":\\"unknown\\",\\"tenant\\":\\"TEST_TENANT\\",\\"vehicleType\\":\\"CARMODEL__FIAT_500_312\\",\\"subjectId\\":\\"15afc9be-5e9f-4ca0-b5bd-795420876b09\\",\\"operationMode\\":\\"SAFETY_CALL\\",\\"deviceType\\":\\"hailysharey\\"}},\\"revision\\":4206,\\"timestamp\\":\\"2022-07-12T11:17:07.551341075Z\\"}",\n  "Timestamp" : "2022-07-12T11:17:07.585Z",\n  "SignatureVersion" : "1",\n  "Signature" : "p8ZAMYlyEkbAG+Bg31+ZmUVvw4LN7FC40JoGmGD1Cye7qJh4dXLIuptICLYvMgcYjeb5SVEavW7DWm7dKALGYuRnJH5ffy4Kwd7P6P63IOD1tLHvYMpGSxwSJX4gvgBW6juqkd3lqLrwOVQ21PgGVtdFI/xD8BK7UhDutQZKtWhDXVAWpV1Bqls0m6edOoGu+yhfBwOGG7Kv+AYXQ63xgKseZnsLCRMU5KU4la10Ik/zjk6HSgsI2iWE5hEK1nMWH+Lrb4gxfLjnOGJaUyTxUc6c5uapWPnytc9bKz9/ARqaXgV146nzzr86vjlk26bRayLX9Q5H6mm/wTmQPg1uDw==",\n  "SigningCertURL" : "https://sns.eu-central-1.amazonaws.com/SimpleNotificationService-7ff5318490ec183fbaddaa2a969abfda.pem",\n  "UnsubscribeURL" : "https://sns.eu-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:eu-central-1:736745337734:prod-inputEventsTerraform:23a2a7a5-1fd3-4bbe-b766-1da13b0577d9",\n  "MessageAttributes" : {\n    "deviceType" : {"Type":"String","Value":"hailysharey"},\n    "operationMode" : {"Type":"String","Value":"SAFETY_CALL"},\n    "eventType" : {"Type":"String","Value":"com.bosch.ivs.videorecorder.UploadRecordingEvent"},\n    "tenant" : {"Type":"String","Value":"TEST_TENANT"},\n    "subjectId" : {"Type":"String","Value":"15afc9be-5e9f-4ca0-b5bd-795420876b09"}\n  }\n}',
    'Attributes': {
        'SentTimestamp': '1657624627631'}}


sqs_message_queue_download_norecordingid = {
    'MessageId': '6615420b-68df-4b65-94e3-8e4ed63935f4',
    'ReceiptHandle': 'AQEBhAkFOkQgJridT/VXqegxOFUc9D8VpMaclfNDlkOw1GJ78ocsIWRujqkYFSm1hfc11vC9i9Yjjspw6Qnq4qfpv1DWCX17ciEz1N5wZDmUa6o56RlHUwSBJLcnY3URXmEaXMM3rGnUkYV0x6G9GWOw4oV+BOnFH6TnUvDS/UBlDax/zGPqPOz6kqYkHP8MS7fn4FuwTr9LuBr4m/bxUcThgmyNaBk7piDgpChbd9PZ2G6zmt3axqYoaGummttEzabOrt1I+IWxO+Yst5MufZiY5/DZlIwj3Jng/ubXT4HY038S9JGZSXKjFMM3L2wkQ4MEjwANOXKJtv8/x/HbBhcqUoCuOdhee/7gKHpczMUNkHZ1rQAgY0l1UzxQt1OG6AMe7Os5SBhQ9g2O5LNgJ+cHgAVDJwbtV7xPFwN6Q3NeFIQ=',
    'MD5OfBody': 'c62f87681f2317a323c99a05dd13ef63',
    'Body': '{\n  "Type" : "Notification",\n  "MessageId" : "d172193a-1f8c-5487-9867-427844fa2dce",\n  "TopicArn" : "arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events",\n  "Message" : "{\\"streamName\\":\\"datanauts_DATANAUTS_DEV_01_TrainingRecorder\\",\\"footageFrom\\":1657297040802,\\"footageTo\\":1657297074110,\\"uploadStarted\\":1657297192968,\\"uploadFinished\\":1657297196322}",\n  "Timestamp" : "2022-07-08T16:20:06.865Z",\n  "SignatureVersion" : "1",\n  "Signature" : "nAsyjqO90ZlZr/SF99sqeDy5wU8zbduZrPiSN+KeG88lzpEvIrytXie2TdC0LHqoKtp2FAKdO91bXyaSJthQLO/hmlnTX5GMG7H2wbnBDuELt2hQNdbU0Y1Jjg6d8DFcxVAVfV0KoUM6uBAiQdMYu+AxqshDL16/sB44TLcSujx3zXAdaS/6bPmayFu7ojWTQWZ0cUQQajzgRCb1OvT73utLSNQaAFh+2F3WPIk6gM1nyoKdii5X53CduO2GWjjX6sF9CqHANA+mJZ4dcD6KyG0SUrOqD/q4PRCVsyTNUd5oJ5+J9XfNnGZ4L1QgtTX36zkFsGjYQhVWiYVs6tVoRg==",\n  "SigningCertURL" : "https://sns.eu-central-1.amazonaws.com/SimpleNotificationService-7ff5318490ec183fbaddaa2a969abfda.pem",\n  "UnsubscribeURL" : "https://sns.eu-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events:e6853099-4723-45cc-b9ed-751484360ce8",\n  "MessageAttributes" : {\n    "recorder" : {"Type":"String","Value":"TRAINING"},\n    "deviceId" : {"Type":"String","Value":"DATANAUTS_DEV_01"},\n    "tenant" : {"Type":"String","Value":"datanauts"}\n  }\n}',
    'Attributes': {
        'SentTimestamp': '1657297206893'}}


sqs_message_queue_download = {
    'MessageId': '6615420b-68df-4b65-94e3-8e4ed63935f4',
    'ReceiptHandle': 'AQEBhAkFOkQgJridT/VXqegxOFUc9D8VpMaclfNDlkOw1GJ78ocsIWRujqkYFSm1hfc11vC9i9Yjjspw6Qnq4qfpv1DWCX17ciEz1N5wZDmUa6o56RlHUwSBJLcnY3URXmEaXMM3rGnUkYV0x6G9GWOw4oV+BOnFH6TnUvDS/UBlDax/zGPqPOz6kqYkHP8MS7fn4FuwTr9LuBr4m/bxUcThgmyNaBk7piDgpChbd9PZ2G6zmt3axqYoaGummttEzabOrt1I+IWxO+Yst5MufZiY5/DZlIwj3Jng/ubXT4HY038S9JGZSXKjFMM3L2wkQ4MEjwANOXKJtv8/x/HbBhcqUoCuOdhee/7gKHpczMUNkHZ1rQAgY0l1UzxQt1OG6AMe7Os5SBhQ9g2O5LNgJ+cHgAVDJwbtV7xPFwN6Q3NeFIQ=',
    'MD5OfBody': 'c62f87681f2317a323c99a05dd13ef63',
    'Body': '{\n  "Type" : "Notification",\n  "MessageId" : "d172193a-1f8c-5487-9867-427844fa2dce",\n  "TopicArn" : "arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events",\n  "Message" : "{\\"streamName\\":\\"datanauts_DATANAUTS_DEV_01_TrainingRecorder\\",\\"footageFrom\\":1657297040802,\\"footageTo\\":1657297074110,\\"uploadStarted\\":1657297192968,\\"uploadFinished\\":1657297196322}",\n  "Timestamp" : "2022-07-08T16:20:06.865Z",\n  "SignatureVersion" : "1",\n  "Signature" : "nAsyjqO90ZlZr/SF99sqeDy5wU8zbduZrPiSN+KeG88lzpEvIrytXie2TdC0LHqoKtp2FAKdO91bXyaSJthQLO/hmlnTX5GMG7H2wbnBDuELt2hQNdbU0Y1Jjg6d8DFcxVAVfV0KoUM6uBAiQdMYu+AxqshDL16/sB44TLcSujx3zXAdaS/6bPmayFu7ojWTQWZ0cUQQajzgRCb1OvT73utLSNQaAFh+2F3WPIk6gM1nyoKdii5X53CduO2GWjjX6sF9CqHANA+mJZ4dcD6KyG0SUrOqD/q4PRCVsyTNUd5oJ5+J9XfNnGZ4L1QgtTX36zkFsGjYQhVWiYVs6tVoRg==",\n  "SigningCertURL" : "https://sns.eu-central-1.amazonaws.com/SimpleNotificationService-7ff5318490ec183fbaddaa2a969abfda.pem",\n  "UnsubscribeURL" : "https://sns.eu-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events:e6853099-4723-45cc-b9ed-751484360ce8",\n  "MessageAttributes" : {\n    "recorder" : {"Type":"String","Value":"TRAINING"},\n    "recordingId" : {"Type":"String","Value":"TrainingRecorder-b8f0525f-706c-431a-a93b-0e9a8b66fd6c"},\n    "deviceId" : {"Type":"String","Value":"DATANAUTS_DEV_01"},\n    "tenant" : {"Type":"String","Value":"datanauts"}\n  }\n}',
    'Attributes': {
        'SentTimestamp': '1657297206893'}}

sqs_message_queue_download_bad_tenant = {
    'MessageId': '6615420b-68df-4b65-94e3-8e4ed63935f4',
    'ReceiptHandle': 'AQEBhAkFOkQgJridT/VXqegxOFUc9D8VpMaclfNDlkOw1GJ78ocsIWRujqkYFSm1hfc11vC9i9Yjjspw6Qnq4qfpv1DWCX17ciEz1N5wZDmUa6o56RlHUwSBJLcnY3URXmEaXMM3rGnUkYV0x6G9GWOw4oV+BOnFH6TnUvDS/UBlDax/zGPqPOz6kqYkHP8MS7fn4FuwTr9LuBr4m/bxUcThgmyNaBk7piDgpChbd9PZ2G6zmt3axqYoaGummttEzabOrt1I+IWxO+Yst5MufZiY5/DZlIwj3Jng/ubXT4HY038S9JGZSXKjFMM3L2wkQ4MEjwANOXKJtv8/x/HbBhcqUoCuOdhee/7gKHpczMUNkHZ1rQAgY0l1UzxQt1OG6AMe7Os5SBhQ9g2O5LNgJ+cHgAVDJwbtV7xPFwN6Q3NeFIQ=',
    'MD5OfBody': 'c62f87681f2317a323c99a05dd13ef63',
    'Body': '{\n  "Type" : "Notification",\n  "MessageId" : "d172193a-1f8c-5487-9867-427844fa2dce",\n  "TopicArn" : "arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events",\n  "Message" : "{\\"streamName\\":\\"datanauts_DATANAUTS_DEV_01_TrainingRecorder\\",\\"footageFrom\\":1657297040802,\\"footageTo\\":1657297074110,\\"uploadStarted\\":1657297192968,\\"uploadFinished\\":1657297196322}",\n  "Timestamp" : "2022-07-08T16:20:06.865Z",\n  "SignatureVersion" : "1",\n  "Signature" : "nAsyjqO90ZlZr/SF99sqeDy5wU8zbduZrPiSN+KeG88lzpEvIrytXie2TdC0LHqoKtp2FAKdO91bXyaSJthQLO/hmlnTX5GMG7H2wbnBDuELt2hQNdbU0Y1Jjg6d8DFcxVAVfV0KoUM6uBAiQdMYu+AxqshDL16/sB44TLcSujx3zXAdaS/6bPmayFu7ojWTQWZ0cUQQajzgRCb1OvT73utLSNQaAFh+2F3WPIk6gM1nyoKdii5X53CduO2GWjjX6sF9CqHANA+mJZ4dcD6KyG0SUrOqD/q4PRCVsyTNUd5oJ5+J9XfNnGZ4L1QgtTX36zkFsGjYQhVWiYVs6tVoRg==",\n  "SigningCertURL" : "https://sns.eu-central-1.amazonaws.com/SimpleNotificationService-7ff5318490ec183fbaddaa2a969abfda.pem",\n  "UnsubscribeURL" : "https://sns.eu-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events:e6853099-4723-45cc-b9ed-751484360ce8",\n  "MessageAttributes" : {\n    "recorder" : {"Type":"String","Value":"TRAINING"},\n    "recordingId" : {"Type":"String","Value":"TrainingRecorder-b8f0525f-706c-431a-a93b-0e9a8b66fd6c"},\n    "deviceId" : {"Type":"String","Value":"DATANAUTS_DEV_01"},\n    "tenant" : {"Type":"String","Value":"TEST_TENANT"}\n  }\n}',
    'Attributes': {
        'SentTimestamp': '1657297206893'}}

sqs_message_queue_download_bad_topicarn = {
    'MessageId': '6615420b-68df-4b65-94e3-8e4ed63935f4',
    'ReceiptHandle': 'AQEBhAkFOkQgJridT/VXqegxOFUc9D8VpMaclfNDlkOw1GJ78ocsIWRujqkYFSm1hfc11vC9i9Yjjspw6Qnq4qfpv1DWCX17ciEz1N5wZDmUa6o56RlHUwSBJLcnY3URXmEaXMM3rGnUkYV0x6G9GWOw4oV+BOnFH6TnUvDS/UBlDax/zGPqPOz6kqYkHP8MS7fn4FuwTr9LuBr4m/bxUcThgmyNaBk7piDgpChbd9PZ2G6zmt3axqYoaGummttEzabOrt1I+IWxO+Yst5MufZiY5/DZlIwj3Jng/ubXT4HY038S9JGZSXKjFMM3L2wkQ4MEjwANOXKJtv8/x/HbBhcqUoCuOdhee/7gKHpczMUNkHZ1rQAgY0l1UzxQt1OG6AMe7Os5SBhQ9g2O5LNgJ+cHgAVDJwbtV7xPFwN6Q3NeFIQ=',
    'MD5OfBody': 'c62f87681f2317a323c99a05dd13ef63',
    'Body': '{\n  "Type" : "Notification",\n  "MessageId" : "d172193a-1f8c-5487-9867-427844fa2dce",\n  "TopicArn" : "arn:aws:sns:eu-central-1:213279581081:sdfsdf",\n  "Message" : "{\\"streamName\\":\\"datanauts_DATANAUTS_DEV_01_TrainingRecorder\\",\\"footageFrom\\":1657297040802,\\"footageTo\\":1657297074110,\\"uploadStarted\\":1657297192968,\\"uploadFinished\\":1657297196322}",\n  "Timestamp" : "2022-07-08T16:20:06.865Z",\n  "SignatureVersion" : "1",\n  "Signature" : "nAsyjqO90ZlZr/SF99sqeDy5wU8zbduZrPiSN+KeG88lzpEvIrytXie2TdC0LHqoKtp2FAKdO91bXyaSJthQLO/hmlnTX5GMG7H2wbnBDuELt2hQNdbU0Y1Jjg6d8DFcxVAVfV0KoUM6uBAiQdMYu+AxqshDL16/sB44TLcSujx3zXAdaS/6bPmayFu7ojWTQWZ0cUQQajzgRCb1OvT73utLSNQaAFh+2F3WPIk6gM1nyoKdii5X53CduO2GWjjX6sF9CqHANA+mJZ4dcD6KyG0SUrOqD/q4PRCVsyTNUd5oJ5+J9XfNnGZ4L1QgtTX36zkFsGjYQhVWiYVs6tVoRg==",\n  "SigningCertURL" : "https://sns.eu-central-1.amazonaws.com/SimpleNotificationService-7ff5318490ec183fbaddaa2a969abfda.pem",\n  "UnsubscribeURL" : "https://sns.eu-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events:e6853099-4723-45cc-b9ed-751484360ce8",\n  "MessageAttributes" : {\n    "recorder" : {"Type":"String","Value":"TRAINING"},\n    "recordingId" : {"Type":"String","Value":"TrainingRecorder-b8f0525f-706c-431a-a93b-0e9a8b66fd6c"},\n    "deviceId" : {"Type":"String","Value":"DATANAUTS_DEV_01"},\n    "tenant" : {"Type":"String","Value":"datanauts"}\n  }\n}',
    'Attributes': {
        'SentTimestamp': '1657297206893'}}

sqs_message_queue_download_no_topicarn = {
    'MessageId': '6615420b-68df-4b65-94e3-8e4ed63935f4',
    'ReceiptHandle': 'AQEBhAkFOkQgJridT/VXqegxOFUc9D8VpMaclfNDlkOw1GJ78ocsIWRujqkYFSm1hfc11vC9i9Yjjspw6Qnq4qfpv1DWCX17ciEz1N5wZDmUa6o56RlHUwSBJLcnY3URXmEaXMM3rGnUkYV0x6G9GWOw4oV+BOnFH6TnUvDS/UBlDax/zGPqPOz6kqYkHP8MS7fn4FuwTr9LuBr4m/bxUcThgmyNaBk7piDgpChbd9PZ2G6zmt3axqYoaGummttEzabOrt1I+IWxO+Yst5MufZiY5/DZlIwj3Jng/ubXT4HY038S9JGZSXKjFMM3L2wkQ4MEjwANOXKJtv8/x/HbBhcqUoCuOdhee/7gKHpczMUNkHZ1rQAgY0l1UzxQt1OG6AMe7Os5SBhQ9g2O5LNgJ+cHgAVDJwbtV7xPFwN6Q3NeFIQ=',
    'MD5OfBody': 'c62f87681f2317a323c99a05dd13ef63',
    'Body': '{\n  "Type" : "Notification",\n  "MessageId" : "d172193a-1f8c-5487-9867-427844fa2dce",\n  "Message" : "{\\"streamName\\":\\"datanauts_DATANAUTS_DEV_01_TrainingRecorder\\",\\"footageFrom\\":1657297040802,\\"footageTo\\":1657297074110,\\"uploadStarted\\":1657297192968,\\"uploadFinished\\":1657297196322}",\n  "Timestamp" : "2022-07-08T16:20:06.865Z",\n  "SignatureVersion" : "1",\n  "Signature" : "nAsyjqO90ZlZr/SF99sqeDy5wU8zbduZrPiSN+KeG88lzpEvIrytXie2TdC0LHqoKtp2FAKdO91bXyaSJthQLO/hmlnTX5GMG7H2wbnBDuELt2hQNdbU0Y1Jjg6d8DFcxVAVfV0KoUM6uBAiQdMYu+AxqshDL16/sB44TLcSujx3zXAdaS/6bPmayFu7ojWTQWZ0cUQQajzgRCb1OvT73utLSNQaAFh+2F3WPIk6gM1nyoKdii5X53CduO2GWjjX6sF9CqHANA+mJZ4dcD6KyG0SUrOqD/q4PRCVsyTNUd5oJ5+J9XfNnGZ4L1QgtTX36zkFsGjYQhVWiYVs6tVoRg==",\n  "SigningCertURL" : "https://sns.eu-central-1.amazonaws.com/SimpleNotificationService-7ff5318490ec183fbaddaa2a969abfda.pem",\n  "UnsubscribeURL" : "https://sns.eu-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events:e6853099-4723-45cc-b9ed-751484360ce8",\n  "MessageAttributes" : {\n    "recorder" : {"Type":"String","Value":"TRAINING"},\n    "recordingId" : {"Type":"String","Value":"TrainingRecorder-b8f0525f-706c-431a-a93b-0e9a8b66fd6c"},\n    "deviceId" : {"Type":"String","Value":"DATANAUTS_DEV_01"},\n    "tenant" : {"Type":"String","Value":"datanauts"}\n  }\n}',
    'Attributes': {
        'SentTimestamp': '1657297206893'}}

sqs_message_queue_download_bad_recorder = {
    'MessageId': '6615420b-68df-4b65-94e3-8e4ed63935f4',
    'ReceiptHandle': 'AQEBhAkFOkQgJridT/VXqegxOFUc9D8VpMaclfNDlkOw1GJ78ocsIWRujqkYFSm1hfc11vC9i9Yjjspw6Qnq4qfpv1DWCX17ciEz1N5wZDmUa6o56RlHUwSBJLcnY3URXmEaXMM3rGnUkYV0x6G9GWOw4oV+BOnFH6TnUvDS/UBlDax/zGPqPOz6kqYkHP8MS7fn4FuwTr9LuBr4m/bxUcThgmyNaBk7piDgpChbd9PZ2G6zmt3axqYoaGummttEzabOrt1I+IWxO+Yst5MufZiY5/DZlIwj3Jng/ubXT4HY038S9JGZSXKjFMM3L2wkQ4MEjwANOXKJtv8/x/HbBhcqUoCuOdhee/7gKHpczMUNkHZ1rQAgY0l1UzxQt1OG6AMe7Os5SBhQ9g2O5LNgJ+cHgAVDJwbtV7xPFwN6Q3NeFIQ=',
    'MD5OfBody': 'c62f87681f2317a323c99a05dd13ef63',
    'Body': '{\n  "Type" : "Notification",\n  "MessageId" : "d172193a-1f8c-5487-9867-427844fa2dce",\n  "TopicArn" : "arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events",\n  "Message" : "{\\"streamName\\":\\"datanauts_DATANAUTS_DEV_01_FrontRecorder\\",\\"footageFrom\\":1657297040802,\\"footageTo\\":1657297074110,\\"uploadStarted\\":1657297192968,\\"uploadFinished\\":1657297196322}",\n  "Timestamp" : "2022-07-08T16:20:06.865Z",\n  "SignatureVersion" : "1",\n  "Signature" : "nAsyjqO90ZlZr/SF99sqeDy5wU8zbduZrPiSN+KeG88lzpEvIrytXie2TdC0LHqoKtp2FAKdO91bXyaSJthQLO/hmlnTX5GMG7H2wbnBDuELt2hQNdbU0Y1Jjg6d8DFcxVAVfV0KoUM6uBAiQdMYu+AxqshDL16/sB44TLcSujx3zXAdaS/6bPmayFu7ojWTQWZ0cUQQajzgRCb1OvT73utLSNQaAFh+2F3WPIk6gM1nyoKdii5X53CduO2GWjjX6sF9CqHANA+mJZ4dcD6KyG0SUrOqD/q4PRCVsyTNUd5oJ5+J9XfNnGZ4L1QgtTX36zkFsGjYQhVWiYVs6tVoRg==",\n  "SigningCertURL" : "https://sns.eu-central-1.amazonaws.com/SimpleNotificationService-7ff5318490ec183fbaddaa2a969abfda.pem",\n  "UnsubscribeURL" : "https://sns.eu-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events:e6853099-4723-45cc-b9ed-751484360ce8",\n  "MessageAttributes" : {\n    "recorder" : {"Type":"String","Value":"TRAINING"},\n    "recordingId" : {"Type":"String","Value":"FrontRecorder-b8f0525f-706c-431a-a93b-0e9a8b66fd6c"},\n    "deviceId" : {"Type":"String","Value":"DATANAUTS_DEV_01"},\n    "tenant" : {"Type":"String","Value":"datanauts"}\n  }\n}',
    'Attributes': {
        'SentTimestamp': '1657297206893'}}

sqs_message_queue_download_bad_streamname = {
    'MessageId': '6615420b-68df-4b65-94e3-8e4ed63935f4',
    'ReceiptHandle': 'AQEBhAkFOkQgJridT/VXqegxOFUc9D8VpMaclfNDlkOw1GJ78ocsIWRujqkYFSm1hfc11vC9i9Yjjspw6Qnq4qfpv1DWCX17ciEz1N5wZDmUa6o56RlHUwSBJLcnY3URXmEaXMM3rGnUkYV0x6G9GWOw4oV+BOnFH6TnUvDS/UBlDax/zGPqPOz6kqYkHP8MS7fn4FuwTr9LuBr4m/bxUcThgmyNaBk7piDgpChbd9PZ2G6zmt3axqYoaGummttEzabOrt1I+IWxO+Yst5MufZiY5/DZlIwj3Jng/ubXT4HY038S9JGZSXKjFMM3L2wkQ4MEjwANOXKJtv8/x/HbBhcqUoCuOdhee/7gKHpczMUNkHZ1rQAgY0l1UzxQt1OG6AMe7Os5SBhQ9g2O5LNgJ+cHgAVDJwbtV7xPFwN6Q3NeFIQ=',
    'MD5OfBody': 'c62f87681f2317a323c99a05dd13ef63',
    'Body': '{\n  "Type" : "Notification",\n  "MessageId" : "d172193a-1f8c-5487-9867-427844fa2dce",\n   "TopicArn" : "arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events",\n   "Message" : "{\\"streamName\\":\\"\\",\\"footageFrom\\":1657297040802,\\"footageTo\\":1657297074110,\\"uploadStarted\\":1657297192968,\\"uploadFinished\\":1657297196322}",\n  "Timestamp" : "2022-07-08T16:20:06.865Z",\n  "SignatureVersion" : "1",\n  "Signature" : "nAsyjqO90ZlZr/SF99sqeDy5wU8zbduZrPiSN+KeG88lzpEvIrytXie2TdC0LHqoKtp2FAKdO91bXyaSJthQLO/hmlnTX5GMG7H2wbnBDuELt2hQNdbU0Y1Jjg6d8DFcxVAVfV0KoUM6uBAiQdMYu+AxqshDL16/sB44TLcSujx3zXAdaS/6bPmayFu7ojWTQWZ0cUQQajzgRCb1OvT73utLSNQaAFh+2F3WPIk6gM1nyoKdii5X53CduO2GWjjX6sF9CqHANA+mJZ4dcD6KyG0SUrOqD/q4PRCVsyTNUd5oJ5+J9XfNnGZ4L1QgtTX36zkFsGjYQhVWiYVs6tVoRg==",\n  "SigningCertURL" : "https://sns.eu-central-1.amazonaws.com/SimpleNotificationService-7ff5318490ec183fbaddaa2a969abfda.pem",\n  "UnsubscribeURL" : "https://sns.eu-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:eu-central-1:213279581081:dev-trash-footage-events:e6853099-4723-45cc-b9ed-751484360ce8",\n  "MessageAttributes" : {\n    "recorder" : {"Type":"String","Value":"TRAINING"},\n    "recordingId" : {"Type":"String","Value":"FrontRecorder-b8f0525f-706c-431a-a93b-0e9a8b66fd6c"},\n    "deviceId" : {"Type":"String","Value":"DATANAUTS_DEV_01"},\n    "tenant" : {"Type":"String","Value":"datanauts"}\n  }\n}',
    'Attributes': {
        'SentTimestamp': '1657297206893'}}


@pytest.mark.unit
class TestChunk:
    fields = ["uuid", "upload_status", "start_timestamp_ms", "end_timestamp_ms", "payload_size"]

    def test_empty_input(self):
        chunk_description = dict()
        obj = Chunk(chunk_description)
        for field in self.fields:
            assert not eval(f"obj.{field}")

    def test_valid_input(self):
        chunk_description = dict(uuid=1, upload_status="status", start_timestamp_ms=123,
                                 end_timestamp_ms=321, payload_size=1000)
        obj = Chunk(chunk_description)
        for field in self.fields:
            assert eval(f"obj.{field}") == chunk_description[f"{field}"]


@pytest.mark.unit
class TestMessage:
    fields = ["messageid", "receipthandle", "attributes", "timestamp",
              "messageattributes", "message", "tenant", "topicarn", "deviceid", "body"]

    def test_empty_input(self):
        sqs_message = dict()
        obj = Message(sqs_message)
        for field in self.fields:
            assert not eval(f"obj.{field}")

    def test_valid_input(self):
        expected = {
            'messageid': '6615420b-68df-4b65-94e3-8e4ed63935f4',
            'receipthandle': 'AQEBhAkFOkQgJridT/VXqegxOFUc9D8VpMaclfNDlkOw1GJ78ocsIWRujqkYFSm1hfc11vC9i9Yjjspw6Qnq4qfpv1DWCX17ciEz1N5wZDmUa6o56RlHUwSBJLcnY3URXmEaXMM3rGnUkYV0x6G9GWOw4oV+BOnFH6TnUvDS/UBlDax/zGPqPOz6kqYkHP8MS7fn4FuwTr9LuBr4m/bxUcThgmyNaBk7piDgpChbd9PZ2G6zmt3axqYoaGummttEzabOrt1I+IWxO+Yst5MufZiY5/DZlIwj3Jng/ubXT4HY038S9JGZSXKjFMM3L2wkQ4MEjwANOXKJtv8/x/HbBhcqUoCuOdhee/7gKHpczMUNkHZ1rQAgY0l1UzxQt1OG6AMe7Os5SBhQ9g2O5LNgJ+cHgAVDJwbtV7xPFwN6Q3NeFIQ=',
            'attributes': dict(SentTimestamp='1657297206893'),
            'timestamp': '2022-07-08T16:20:06',
            'messageattributes': {'recorder': {'Type': 'String', 'Value': 'TRAINING'},
                                  'recordingId': {'Type': 'String', 'Value': 'TrainingRecorder-b8f0525f-706c-431a-a93b-0e9a8b66fd6c'},
                                  'deviceId': {'Type': 'String', 'Value': 'DATANAUTS_DEV_01'},
                                  'tenant': {'Type': 'String', 'Value': 'datanauts'}
                                  },
            'deviceid': None,
            'tenant': 'datanauts',
            'topicarn': 'dev-video-footage-events',
            'message': {'streamName': 'datanauts_DATANAUTS_DEV_01_TrainingRecorder',
                        'footageFrom': 1657297040802,
                        'footageTo': 1657297074110,
                        'uploadStarted': 1657297192968,
                        'uploadFinished': 1657297196322
                        },
            'body': '{\n  "Type" : "Notification",\n  "MessageId" : "d172193a-1f8c-5487-9867-427844fa2dce",\n  "TopicArn" : "arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events",\n  "Message" : "{\\"streamName\\":\\"datanauts_DATANAUTS_DEV_01_TrainingRecorder\\",\\"footageFrom\\":1657297040802,\\"footageTo\\":1657297074110,\\"uploadStarted\\":1657297192968,\\"uploadFinished\\":1657297196322}",\n  "Timestamp" : "2022-07-08T16:20:06.865Z",\n  "SignatureVersion" : "1",\n  "Signature" : "nAsyjqO90ZlZr/SF99sqeDy5wU8zbduZrPiSN+KeG88lzpEvIrytXie2TdC0LHqoKtp2FAKdO91bXyaSJthQLO/hmlnTX5GMG7H2wbnBDuELt2hQNdbU0Y1Jjg6d8DFcxVAVfV0KoUM6uBAiQdMYu+AxqshDL16/sB44TLcSujx3zXAdaS/6bPmayFu7ojWTQWZ0cUQQajzgRCb1OvT73utLSNQaAFh+2F3WPIk6gM1nyoKdii5X53CduO2GWjjX6sF9CqHANA+mJZ4dcD6KyG0SUrOqD/q4PRCVsyTNUd5oJ5+J9XfNnGZ4L1QgtTX36zkFsGjYQhVWiYVs6tVoRg==",\n  "SigningCertURL" : "https://sns.eu-central-1.amazonaws.com/SimpleNotificationService-7ff5318490ec183fbaddaa2a969abfda.pem",\n  "UnsubscribeURL" : "https://sns.eu-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events:e6853099-4723-45cc-b9ed-751484360ce8",\n  "MessageAttributes" : {\n    "recorder" : {"Type":"String","Value":"TRAINING"},\n    "recordingId" : {"Type":"String","Value":"TrainingRecorder-b8f0525f-706c-431a-a93b-0e9a8b66fd6c"},\n    "deviceId" : {"Type":"String","Value":"DATANAUTS_DEV_01"},\n    "tenant" : {"Type":"String","Value":"datanauts"}\n  }\n}'
        }
        obj = Message(sqs_message_queue_download)
        for field in self.fields:
            if field == "timestamp":  # special case, datetime comes formatted
                aux_timestamp = expected["timestamp"]
                aux_timestamp = datetime.strptime(aux_timestamp, "%Y-%m-%dT%H:%M:%S").timestamp()
                timestamp = datetime.fromtimestamp(aux_timestamp / 1000.0).strftime('%Y-%m-%d %H:%M:%S')
                assert obj.timestamp == timestamp

            elif field == "body":  # special case, body comes wrapped as string
                aux_body = json.loads(expected["body"].replace("\'", "\""))
                assert obj.body == aux_body

            else:
                assert eval(f"obj.{field}") == expected[f"{field}"]


@pytest.mark.unit
class TestVideoMessage:
    fields = ["messageid", "receipthandle", "attributes", "timestamp", "messageattributes", "message",
              "tenant", "topicarn", "deviceid", "body", "streamname", "recording_type", "recordingid", "footagefrom",
              "footageto", "uploadstarted", "uploadfinished"]

    def test_empty_input(self):
        sqs_message = dict()
        obj = VideoMessage(sqs_message)
        for field in self.fields:
            assert not eval(f"obj.{field}")

    def test_valid_input(self):
        expected = {
            'messageid': '6615420b-68df-4b65-94e3-8e4ed63935f4',
            'receipthandle': 'AQEBhAkFOkQgJridT/VXqegxOFUc9D8VpMaclfNDlkOw1GJ78ocsIWRujqkYFSm1hfc11vC9i9Yjjspw6Qnq4qfpv1DWCX17ciEz1N5wZDmUa6o56RlHUwSBJLcnY3URXmEaXMM3rGnUkYV0x6G9GWOw4oV+BOnFH6TnUvDS/UBlDax/zGPqPOz6kqYkHP8MS7fn4FuwTr9LuBr4m/bxUcThgmyNaBk7piDgpChbd9PZ2G6zmt3axqYoaGummttEzabOrt1I+IWxO+Yst5MufZiY5/DZlIwj3Jng/ubXT4HY038S9JGZSXKjFMM3L2wkQ4MEjwANOXKJtv8/x/HbBhcqUoCuOdhee/7gKHpczMUNkHZ1rQAgY0l1UzxQt1OG6AMe7Os5SBhQ9g2O5LNgJ+cHgAVDJwbtV7xPFwN6Q3NeFIQ=',
            'attributes': dict(SentTimestamp='1657297206893'),
            'timestamp': '2022-07-08T16:20:06',
            'messageattributes': {'recorder': {'Type': 'String', 'Value': 'TRAINING'},
                                  'recordingId': {'Type': 'String', 'Value': 'TrainingRecorder-b8f0525f-706c-431a-a93b-0e9a8b66fd6c'},
                                  'deviceId': {'Type': 'String', 'Value': 'DATANAUTS_DEV_01'},
                                  'tenant': {'Type': 'String', 'Value': 'datanauts'}
                                  },
            'deviceid': "DATANAUTS_DEV_01",
            'tenant': 'datanauts',
            'topicarn': 'dev-video-footage-events',
            'message': {'streamName': 'datanauts_DATANAUTS_DEV_01_TrainingRecorder',
                        'footageFrom': 1657297040802,
                        'footageTo': 1657297074110,
                        'uploadStarted': 1657297192968,
                        'uploadFinished': 1657297196322
                        },
            'body': '{\n  "Type" : "Notification",\n  "MessageId" : "d172193a-1f8c-5487-9867-427844fa2dce",\n  "TopicArn" : "arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events",\n  "Message" : "{\\"streamName\\":\\"datanauts_DATANAUTS_DEV_01_TrainingRecorder\\",\\"footageFrom\\":1657297040802,\\"footageTo\\":1657297074110,\\"uploadStarted\\":1657297192968,\\"uploadFinished\\":1657297196322}",\n  "Timestamp" : "2022-07-08T16:20:06.865Z",\n  "SignatureVersion" : "1",\n  "Signature" : "nAsyjqO90ZlZr/SF99sqeDy5wU8zbduZrPiSN+KeG88lzpEvIrytXie2TdC0LHqoKtp2FAKdO91bXyaSJthQLO/hmlnTX5GMG7H2wbnBDuELt2hQNdbU0Y1Jjg6d8DFcxVAVfV0KoUM6uBAiQdMYu+AxqshDL16/sB44TLcSujx3zXAdaS/6bPmayFu7ojWTQWZ0cUQQajzgRCb1OvT73utLSNQaAFh+2F3WPIk6gM1nyoKdii5X53CduO2GWjjX6sF9CqHANA+mJZ4dcD6KyG0SUrOqD/q4PRCVsyTNUd5oJ5+J9XfNnGZ4L1QgtTX36zkFsGjYQhVWiYVs6tVoRg==",\n  "SigningCertURL" : "https://sns.eu-central-1.amazonaws.com/SimpleNotificationService-7ff5318490ec183fbaddaa2a969abfda.pem",\n  "UnsubscribeURL" : "https://sns.eu-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:eu-central-1:213279581081:dev-video-footage-events:e6853099-4723-45cc-b9ed-751484360ce8",\n  "MessageAttributes" : {\n    "recorder" : {"Type":"String","Value":"TRAINING"},\n    "recordingId" : {"Type":"String","Value":"TrainingRecorder-b8f0525f-706c-431a-a93b-0e9a8b66fd6c"},\n    "deviceId" : {"Type":"String","Value":"DATANAUTS_DEV_01"},\n    "tenant" : {"Type":"String","Value":"datanauts"}\n  }\n}',
            "streamname": 'datanauts_DATANAUTS_DEV_01_TrainingRecorder',
            "recording_type": "TrainingRecorder",
            "recordingid": "TrainingRecorder-b8f0525f-706c-431a-a93b-0e9a8b66fd6c",
            "footagefrom": 1657297040802,
            "footageto": 1657297074110,
            "uploadstarted": datetime.fromtimestamp(1657297192968 / 1000.0),
            "uploadfinished": datetime.fromtimestamp(1657297196322 / 1000.0),
        }
        obj = VideoMessage(sqs_message_queue_download)
        for field in self.fields:
            if field == "timestamp":  # special case, datetime comes formatted
                aux_timestamp = expected["timestamp"]
                aux_timestamp = datetime.strptime(aux_timestamp, "%Y-%m-%dT%H:%M:%S").timestamp()
                timestamp = datetime.fromtimestamp(aux_timestamp / 1000.0).strftime('%Y-%m-%d %H:%M:%S')
                assert obj.timestamp == timestamp
            elif field == "body":  # special case, body comes wrapped as string
                aux_body = json.loads(expected["body"].replace("\'", "\""))
                assert obj.body == aux_body
            else:
                assert eval(f"obj.{field}") == expected[f"{field}"]

    def test_validate(self):
        obj = VideoMessage(sqs_message_queue_download)
        assert obj.validate()

        #obj = VideoMessage(sqs_message_queue_download_invalid)
        #assert not obj.validate()

    def test_is_irrelevant(self, config_yml):
        obj = VideoMessage(sqs_message_queue_download)
        assert not obj.is_irrelevant(config_yml.tenant_blacklist, config_yml.recorder_blacklist)

        obj = VideoMessage(sqs_message_queue_download_bad_tenant)
        assert obj.is_irrelevant(config_yml.tenant_blacklist, config_yml.recorder_blacklist)

        obj = VideoMessage(sqs_message_queue_download_bad_recorder)
        assert obj.is_irrelevant(config_yml.tenant_blacklist, config_yml.recorder_blacklist)

        obj = VideoMessage(sqs_message_queue_download_bad_streamname)
        assert obj.is_irrelevant(config_yml.tenant_blacklist, config_yml.recorder_blacklist)

        obj = VideoMessage(sqs_message_queue_download_norecordingid)
        assert obj.is_irrelevant(config_yml.tenant_blacklist, config_yml.recorder_blacklist)

        obj = VideoMessage(sqs_message_queue_download_no_topicarn)
        assert obj.is_irrelevant(config_yml.tenant_blacklist, config_yml.recorder_blacklist)

        obj = VideoMessage(sqs_message_queue_download_bad_topicarn)
        assert obj.is_irrelevant(config_yml.tenant_blacklist, config_yml.recorder_blacklist)


@pytest.mark.unit
class TestSnapshotMessage:
    fields = ["messageid", "receipthandle", "attributes", "timestamp", "messageattributes", "message",
              "tenant", "topicarn", "deviceid", "body", "chunks", "senttimestamp", "eventtype"]

    def test_empty_input(self):
        sqs_message = dict()
        obj = SnapshotMessage(sqs_message)
        for field in self.fields:
            assert not eval(f"obj.{field}")

    def test_valid_input(self):
        expected = {
            'messageid': "8e8d79bb-8a6b-4461-a94d-51c7aa9bb0f1",
            'receipthandle': "AQEBtCBwuG54U0wqc572u5hzyBPmxsd7I+cOT7zAsKG4foVAvgYTG5UDz3DZ07IG6t61OKtInqBeOGpLA0AhQOPdHum2hRXA8RHwu7iznWK6wll/mZGKtLIyPHUG5NflRllxCY698TeVxyqvGgKqWqTQipV1XOTGpxw4X+5L1ScIsTdlLrj1KAGl61h5s+ZEOOvoQiMdP2ecYshf9LSul80BLdNe8l5iAsg/JJwODYhv/hubXSAKjDrLuDxjPQNq8PaCP+WC5h0iWeP3WsPfq1uXvulkPxdm8PGADJJuBw9vwSoHqociFlDP08hYZDqzi5EMDe8+PCoC26l4V9oQ/cWq8k7Peh2nsBulp2f6NIWfen9/5YDkkNVrwMy8MXmmUg7YNPVboGjgeVAfrExighxI+o4/KqgqonU1Qznd44r0nYU=",
            'attributes': {"SentTimestamp": "1657624627631"},
            'timestamp': "2022-07-12T11:17:07",
            'messageattributes': {
                "deviceType": {"Type": "String", "Value": "hailysharey"},
                "operationMode": {"Type": "String", "Value": "SAFETY_CALL"},
                "eventType": {
                    "Type": "String",
                    "Value": "com.bosch.ivs.videorecorder.UploadRecordingEvent"
                },
                "tenant": {"Type": "String", "Value": "TEST_TENANT"},
                "subjectId": {
                    "Type": "String",
                    "Value": "15afc9be-5e9f-4ca0-b5bd-795420876b09"
                }
            },
            'deviceid': "srx_herbie_test_sim_am_01",
            'tenant': "TEST_TENANT",
            'topicarn': "prod-inputEventsTerraform",
            'message': {
                "topic": "com.bosch.rcc/srx_herbie_test_sim_am_01/things/twin/events/modified",
                "headers": {
                    "orig_adapter": "hono-mqtt",
                    "qos": "1",
                    "device_id": "com.bosch.rcc:srx_herbie_test_sim_am_01",
                    "creation-time": "1657624627540",
                    "traceparent": "00-0a84e899503b765b0ca9c96d86390022-98345f5e303cee11-00",
                    "kafka.timestamp": "1657624627540",
                    "kafka.topic": "hono.telemetry.tbccf1729c0ac4f748ef8c4a62a953076_hub",
                    "orig_address": "telemetry",
                    "kafka.key": "com.bosch.rcc:srx_herbie_test_sim_am_01",
                    "ditto-originator": "integration:bccf1729-c0ac-4f74-8ef8-c4a62a953076_things:hub",
                    "response-required": False,
                    "version": 2,
                    "requested-acks": [],
                    "content-type": "application/json",
                    "correlation-id": "2c17e5c9-e687-42a4-914e-1fdac9d42af3"
                },
                "path": "/features/com.bosch.ivs.videorecorder.UploadRecordingEvent",
                "value": {
                    "properties": {
                        "header": {
                            "message_type": "com.bosch.ivs.videorecorder.UploadRecordingEvent",
                            "timestamp_ms": 1657624627537,
                            "message_id": "de13f5cc-dfea-46da-8d89-9e3884e30a24",
                            "device_id": "srx_herbie_test_sim_am_01",
                            "boot_id": "d20ba602-2c06-4405-8ed5-db941573dbbe"
                        },
                        "correlation_id": "bda19c79-eac4-4d87-af31-632208257ab3",
                        "recording_id": "TrainingMultiSnapshot-bc4d26db-9689-4d77-b173-a21fb26776fa",
                        "recorder_name": "TrainingMultiSnapshot",
                        "command_status": {
                            "status_code": "COMMAND_STATUS_CODE__OK",
                            "details": "COMMAND_STATUS_CODE__OK"
                        }
                    }
                },
                "extra": {
                    "attributes": {
                        "vin": "unknown",
                        "tenant": "TEST_TENANT",
                        "vehicleType": "CARMODEL__FIAT_500_312",
                        "subjectId": "15afc9be-5e9f-4ca0-b5bd-795420876b09",
                        "operationMode": "SAFETY_CALL",
                        "deviceType": "hailysharey"
                    }
                },
                "revision": 4206,
                "timestamp": "2022-07-12T11:17:07.551341075Z"
            },
            'body': '{\n  "Type" : "Notification",\n  "MessageId" : "a24584ea-fe55-56a9-bd2f-dfada4266b2c",\n  "TopicArn" : "arn:aws:sns:eu-central-1:736745337734:prod-inputEventsTerraform",\n  "Message" : "{\\"topic\\":\\"com.bosch.rcc/srx_herbie_test_sim_am_01/things/twin/events/modified\\",\\"headers\\":{\\"orig_adapter\\":\\"hono-mqtt\\",\\"qos\\":\\"1\\",\\"device_id\\":\\"com.bosch.rcc:srx_herbie_test_sim_am_01\\",\\"creation-time\\":\\"1657624627540\\",\\"traceparent\\":\\"00-0a84e899503b765b0ca9c96d86390022-98345f5e303cee11-00\\",\\"kafka.timestamp\\":\\"1657624627540\\",\\"kafka.topic\\":\\"hono.telemetry.tbccf1729c0ac4f748ef8c4a62a953076_hub\\",\\"orig_address\\":\\"telemetry\\",\\"kafka.key\\":\\"com.bosch.rcc:srx_herbie_test_sim_am_01\\",\\"ditto-originator\\":\\"integration:bccf1729-c0ac-4f74-8ef8-c4a62a953076_things:hub\\",\\"response-required\\":false,\\"version\\":2,\\"requested-acks\\":[],\\"content-type\\":\\"application/json\\",\\"correlation-id\\":\\"2c17e5c9-e687-42a4-914e-1fdac9d42af3\\"},\\"path\\":\\"/features/com.bosch.ivs.videorecorder.UploadRecordingEvent\\",\\"value\\":{\\"properties\\":{\\"header\\":{\\"message_type\\":\\"com.bosch.ivs.videorecorder.UploadRecordingEvent\\",\\"timestamp_ms\\":1657624627537,\\"message_id\\":\\"de13f5cc-dfea-46da-8d89-9e3884e30a24\\",\\"device_id\\":\\"srx_herbie_test_sim_am_01\\",\\"boot_id\\":\\"d20ba602-2c06-4405-8ed5-db941573dbbe\\"},\\"correlation_id\\":\\"bda19c79-eac4-4d87-af31-632208257ab3\\",\\"recording_id\\":\\"TrainingMultiSnapshot-bc4d26db-9689-4d77-b173-a21fb26776fa\\",\\"recorder_name\\":\\"TrainingMultiSnapshot\\",\\"command_status\\":{\\"status_code\\":\\"COMMAND_STATUS_CODE__OK\\",\\"details\\":\\"COMMAND_STATUS_CODE__OK\\"}}},\\"extra\\":{\\"attributes\\":{\\"vin\\":\\"unknown\\",\\"tenant\\":\\"TEST_TENANT\\",\\"vehicleType\\":\\"CARMODEL__FIAT_500_312\\",\\"subjectId\\":\\"15afc9be-5e9f-4ca0-b5bd-795420876b09\\",\\"operationMode\\":\\"SAFETY_CALL\\",\\"deviceType\\":\\"hailysharey\\"}},\\"revision\\":4206,\\"timestamp\\":\\"2022-07-12T11:17:07.551341075Z\\"}",\n  "Timestamp" : "2022-07-12T11:17:07.585Z",\n  "SignatureVersion" : "1",\n  "Signature" : "p8ZAMYlyEkbAG+Bg31+ZmUVvw4LN7FC40JoGmGD1Cye7qJh4dXLIuptICLYvMgcYjeb5SVEavW7DWm7dKALGYuRnJH5ffy4Kwd7P6P63IOD1tLHvYMpGSxwSJX4gvgBW6juqkd3lqLrwOVQ21PgGVtdFI/xD8BK7UhDutQZKtWhDXVAWpV1Bqls0m6edOoGu+yhfBwOGG7Kv+AYXQ63xgKseZnsLCRMU5KU4la10Ik/zjk6HSgsI2iWE5hEK1nMWH+Lrb4gxfLjnOGJaUyTxUc6c5uapWPnytc9bKz9/ARqaXgV146nzzr86vjlk26bRayLX9Q5H6mm/wTmQPg1uDw==",\n  "SigningCertURL" : "https://sns.eu-central-1.amazonaws.com/SimpleNotificationService-7ff5318490ec183fbaddaa2a969abfda.pem",\n  "UnsubscribeURL" : "https://sns.eu-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:eu-central-1:736745337734:prod-inputEventsTerraform:23a2a7a5-1fd3-4bbe-b766-1da13b0577d9",\n  "MessageAttributes" : {\n    "deviceType" : {"Type":"String","Value":"hailysharey"},\n    "operationMode" : {"Type":"String","Value":"SAFETY_CALL"},\n    "eventType" : {"Type":"String","Value":"com.bosch.ivs.videorecorder.UploadRecordingEvent"},\n    "tenant" : {"Type":"String","Value":"TEST_TENANT"},\n    "subjectId" : {"Type":"String","Value":"15afc9be-5e9f-4ca0-b5bd-795420876b09"}\n  }\n}',
            'chunks': [],
            'senttimestamp': datetime.fromtimestamp(int(1657624627631) / 1000.0),
            'eventtype': 'UploadRecordingEvent'
        }

        obj = SnapshotMessage(sqs_message_queue_selector)
        for field in self.fields:
            if field == "timestamp":  # special case, datetime comes formatted
                aux_timestamp = expected["timestamp"]
                aux_timestamp = datetime.strptime(aux_timestamp, "%Y-%m-%dT%H:%M:%S").timestamp()
                timestamp = datetime.fromtimestamp(aux_timestamp / 1000.0).strftime('%Y-%m-%d %H:%M:%S')
                assert obj.timestamp == timestamp
            elif field == "body":  # special case, body comes wrapped as string
                aux_body = json.loads(expected["body"].replace("\'", "\""))
                assert obj.body == aux_body
            elif field == "senttimestamp":
                aux_senttimestamp = expected["senttimestamp"]
                assert obj.senttimestamp == aux_senttimestamp
            else:
                assert eval(f"obj.{field}") == expected[f"{field}"]

    def test_validate(self):
        obj = SnapshotMessage(sqs_message_queue_selector)
        assert not obj.validate()

        obj = SnapshotMessage(sqs_message_queue_selector_with_chunks)
        assert obj.validate()

    def test_is_irrelevant(self, config_yml):
        obj = SnapshotMessage(sqs_message_queue_selector)
        assert obj.is_irrelevant(config_yml.tenant_blacklist)

        obj = SnapshotMessage(sqs_message_queue_selector_good_tenant)
        assert not obj.is_irrelevant(config_yml.tenant_blacklist)
